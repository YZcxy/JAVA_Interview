# 计算机网络知识点

## 概述

Q：计算机网络的分类？  
A：按照网络作业的**范围**分类：广域网(WAN)、城域网(MAN)、局域网(LAN)。按照网络作用的**使用者**分类：公用网络和专用网络。  
***
Q：互联网的发展历史？  
A：可以分为三个阶段：  
- 单个网络ARPANET：这个阶段主要是一些计算机通过交换机进行连接，这个时候计算机通过连接交换机，就可以直接完成信息的交换，并且连接的计算机不多。  
- 三级结构互联网：这个阶段主要连接的是全美国主要的一些学校、研究所、实验室等拥有计算机的地方  
- 多层次ISP互联网：由ISP（Internet Service Provider）提供网络服务，用户可以自主选择接入互联网。  
***
Q：为什么100M光纤，网速只有12M每秒？  
A：因为 100M/s = 100Mbps = 100Mbit/s，因此 100Mbit/s = (100/8)MB/s = 12.5MB/s。  
***
Q：网络时延的分类？  
A：大体可以分为四类：  
- 发送时延：主要是本机进行网络发送的时候，在本机停留的时间。
- 排队时延：数据包在网络设备中等待被处理的时间。
- 传播时延：数据包在传输介质(铜线、光纤)中的消耗时间。
- 处理时延：数据包到达设备后被处理锁需要的实际。
***
Q：RRT是什么？  
A：RTT（Route-Trip Time）是评估网络质量的一项重要指标，RTT表示的是数据报文在端到端通信中的来回一次的时间，可以使用 ping 命令查看RTT。  
***
Q：什么是OSI七层模型？  
A：OSI 七层模型在制定的时候，是想成为全球计算机都遵循的标准，但是在市场化过程中困难重重。TCP/IP 模型在全球范围内成功的运行了。  
- 应用层(数据)：确定进程之间通信的性质，提供网络与用户应用。  
- 表示层(数据)：主要解决用户信息的语法表示问题，如加解密。  
- 会话层(数据)：提供访问验证和会话管理服务，建立和维护应用之间通信的机制。  
- 传输层(段)：实现网络不同主机上用户进程之间的数据通信，可靠。  
- 网络层(包)：提供逻辑地址(IP)、选路，数据从源端到目的端的传输。  
- 数据链路层(帧)：使用MAC地址访问媒介，错误检测与修正。  
- 物理层(比特流)：设备之间比特流的传输，物理接口。  
![osi7](https://static001.geekbang.org/infoq/c5/c5aa89b0647c77de178d4a605e593c74.png) 
***
Q：什么是TCP/IP四层模型？  
A：TCP/IP 模型是OSI的简化版，只包括网络接口层、网络层、传输层和应用层。  
![TCP/IP](https://static001.geekbang.org/infoq/ce/ce5d6c878b5f7710607f5fcd3fa99cd9.png)
***
Q：TCP/IP四层模型的实际应用？  
A：如下图：  
![app](https://static001.geekbang.org/infoq/f7/f77e6101943a167966c405792db80fc1.png)  
除此之外，还可以通过分层的方法去理解不同的层面  
![level](https://static001.geekbang.org/infoq/34/34950fe99aaef114a420268cdf220268.png)
***

## 物理层

Q：物理层的作用是什么？  
A：物理层主要是为了连接不同的物理设备，比如路由器到计算机之间使用网线连接。然后在线路中传输比特流。  
***
Q：有哪些传输介质？  
A：可分为有线介质和无线介质。其中有线介质包括双绞线、同轴电缆、光纤等。无线介质包括红外线、无线、激光等。  
***
Q：什么是信道？  
A：信道是信号在通信系统中传输的通道。一条通信电路往往包含一个接收信道和一个发送信道，因为发送信息和接收信息的方向不一样，所有这里有两个信道。  
***
Q：信道的分类？  
A：一般可以分为三类：  
- 单工通信信道：只能单向通信，没有反方向反馈的信道。  
- 半双工通信信道：在同一个信号载体上，可以向两个方向传输，但是不能同时传输。  
- 全双工通信信道：在发送数据的同时，也能够接受数据，二者同步进行。  
***
Q：什么是信道复用技术？  
A：如果两台计算机需要通信，就需要有一条信道的存在。如果有很多计算机，不可能为每两者之间都分配一条独立信道。所以信道需要复用和分用。  
![xd](https://static001.geekbang.org/infoq/de/de7cfe45a31148f5bb6fc4de786682d4.png)  
***

## 数据链路层

Q：数据链路层的作用？  
A：数据链路层接管数据报，并将它封装成帧。同时提供透明传输和差错检查的功能。  
***
Q：什么是透明传输？  
A：数据链路层封装成帧，会给数据在前后增加帧的头部和尾部，但是为了不让接收端将位于数据中和控制符一样的字符误认为控制符，需要给数据内的控制符添加一个转义字符。对于上层API是透明操作，无感知的。  
![zy](https://static001.geekbang.org/infoq/4e/4e540e5cf157713f73a2df788945a53f.png)  
***
Q：什么是差错检测？  
A：因为物理层只负责传输比特流，无法控制数据是否出错。数据链路层就担负起了差错检测的功能，差错检测一般包含以下两个部分：  
- 奇偶校验码：奇偶校验码通过在数据流后面添加一位比特位来标识数据中1的个数是奇数还是偶数，例如 `00110010` 这样的数据，奇偶校验码就是 1 。但是奇偶校验码在出现了两位错误的时候，就检测不到错误了。  
- 循环冗余校验：循环冗余校验码是一种广泛使用的差错检测的算法，它是一种根据传输或保存的数据而产生固定位数校验码的方法，当接收端接收到数据之后，就会根据附加到后边的数字，来判断接收到的数据是否有出错。  
***
Q：什么是MAC地址？  
A：MAC 地址也被叫做物理地址，每一个物理设备都拥有唯一的一个 MAC 地址，MAC地址共48位(6个字节)，通常用十六进制表示。  
***
Q：什么是以太网协议？  
A：以太网是一种应用于数据链路层的协议，广泛运用于局域网技术。以太网的数据格式如下：  
![ytw](https://static001.geekbang.org/infoq/e9/e9b4bb3a64bda9023ad85b347e9b80af.png)  
- 目的地址、源地址：其中就是 6 个字节的 MAC 地址。  
- 类型：表示帧数据是哪个协议的数据，如果是网络层的数据就是0800，如果是 ARP 请求，就是0806，如果是 RARP 协议，就是8035。  
- 帧数据：具体的数据。  
- CRC：就是差错检测的循环冗余校验码。  
***
Q：什么是MAC地址表？  
A：MAC 地址表示一个映射，会把 MAC 地址具体映射到硬件的接口上。  
如果局域网内A想要访问B，就会优先去查 MAC 地址表，如果映射不存在，就会发起广播，收到B的回复后，就会将映射存入 MAC 地址表。  
***

## 网络层

Q：什么是IP地址？  
A：IP 地址是指互联网协议地址，是 IP 协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异。IP地址长度为32位，占4个字节。  
***
Q：IP地址的分类？  
A：IP 地址编址方案将 IP 地址空间划分为五类：  
- A类地址：首位是0，第一个字节范围：0~127。
- B类地址：前两位是10，第一个字节范围：128~191。
- C类地址：前三位是110，第一个字节范围：192~223。
- D类地址：前四位是1110，第一个字节范围：224~239。
- E类地址：前四位是1111，保留地址。
其中 A、B、C 是基本类，D 和 E 是特殊地址，作为多播和保留使用。  
***
Q：IP地址和MAC地址的区别？  
A：主要有以下区别：  
- MAC 地址是数据链路层和物理层使用的地址。  
- IP 地址是网络层及以上各层使用的地址，是一种逻辑地址。  
- MAC 地址唯一，不可改变；IP 地址随着网络环境改变。  
***
Q：什么是IP协议？  
A：在物理层，传输着0、1这样的比特流；在数据链路层，传输的是数据帧；在网络层，传输的就叫做 IP 数据报，其中 IP 数据报包含了 IP 首部和数据两个部分。  
![ip](https://static001.geekbang.org/infoq/41/418cdf92105d9164fedf5dd8a1ffc77e.png)  
***
Q：什么是IP首部？  
A：IP协议的首部非常重要，包含格式如下：  
![sb](https://static001.geekbang.org/infoq/0b/0b2618dc8c86b98de76118c1def17c15.png)  

- 版本：占4位，指的是 IP 协议的版本，通信双方的版本必须一致。
- 首部长度：占4位，表示IP首部的长度，最大数值为15，单位是4字节，所以IP首部最长60字节。
- 服务类型：占8位，一般不太关心。
- 总长度：占16位，表示 IP 数据报的总长度，包括了 IP 数据部分。最大值为65535，表示65535字节，远大于数据链路层数据帧的大小，所以在传输中会对IP数据报进行**切片**。
- 标识：无需关心。
- 标记：标记IP报文是否可以进行切片。
- 片偏移：如果 IP 数据报被切片，那么需要用到片偏移来记录当前是第几个偏移的 IP 数据报。
- TTL：占8位，表示 IP 数据报在网络中的**寿命**，每经过一个设备就减一，当 TTL=0 时就会丢弃这个报文，防止报文无限传输。
- 协议：占8位，表示 IP 数据报所携带的具体数据是什么协议(ICMP，TCP，UDP等)。
- 校验和：占16位，校验 IP 首部是否有出错。  
- 源IP地址：发送方的 IP 地址。
- 目的IP地址：想要达到的目的网络设备 IP 地址。 
***
Q：什么是ARP协议？  
A：ARP 协议完成了 IP 地址和物理地址的映射。每台主机都有自己的 ARP 列表(包括交换机)，当源主机需要将一个数据包发送时，会首先检查自己的 ARP 列表中是否存在该 IP 地址的映射。  
- 如果有，就直接将该数据包发送到这个 MAC 地址。  
- 如果没有，就向本地网段发起一个 ARP 请求的广播，查询此 IP 对应的 MAC地址，网络中的所有主机会检查数据包中的目的 IP 是否和自己的 IP 地址一致。  
  - 如果都不一致，就忽略了此包
  - 如果相同，该主机首先将发送端的 MAC 地址和 IP 地址添加到本地的 ARP 表，然后回送给源主机一个 ARP 响应包。
    - 源主机收到了 ARP 响应包，就跟新自己的 ARP 表，然后利用此信息进行传输。
    - 如果源主机一直没有收到 ARP 响应包，表示 ARP 查询失败。  
***
Q：ARP协议的报文信息？  
A：ARP协议的报文信息是直接封装到数据链路层的数据帧中的。  
![arp](https://static001.geekbang.org/infoq/96/964899d2ce7d3756a5a0a66635c3cbc2.png)
***
Q：什么是RARP协议？  
A：RARP（Reverse Address Resolution Protocol）逆地址解析协议，就是做 ARP 相反的工作，可以将 MAC 地址转换为 IP 地址。  
***
Q：什么是回环地址？  
A：127.0.0.1 通常被称为本地回环地址，不属于任何一个有类别的地址，代表着本地虚拟的接口。通常在安装网卡前就可以 ping 通这个地址，可以用来检查本地网络协议，基本数据接口是否正常。  
***
Q：如何划分子网？  
A：划分子网（变长子网掩码 VLSM）：划分子网的方法是从网络的主机号借用若干位作为子网号 subnet-id ，与此同时主机号也减少相应位数（总位数 32 位不变）。  
由此两级 IP 地址可变为三级 IP 地址：IP地址 ::= {<网络号>,<子网号>,<主机号>} ，划分子网只是把 IP 地址的主机号这部分进行再划分，并不改变 IP 地址原来的网络号。  

***
Q：如何划分超网？  
A：构造超网（无分类编址 CIDR）：CIDR 消除了传统的 A 类、B 类和 C 类地址以及划分子网的概念，把 32 位的 IP 地址划分为两个部分。  
例如：128.14.35.7/20 是某个 CIDR 地址块中的一个地址，其前 20 位是网络前缀（用下划线表示的部分），后面的 12 位为主机号  
***
Q：子网掩码的作用？  
A：子网掩码只有一个作用，就是将某个 IP 地址划分成网络地址和主机地址两部分。子网掩码只有一个作用，就是将某个 IP 地址划分成网络地址和主机地址两部分。  
***
Q：ping 的原理是什么？  
A：ping 是基于 ICMP 协议工作的，全称 Internet Control Message Protocol，也就是互联网控制报文协议。ICMP 协议可以报告**错误信息**或者**异常情况**。  
***
Q：什么是 Traceroute ？  
A：Traceroute ，是用来侦测主机到目的主机之间所经路由情况的重要工具。首先计算机A发送了一个 TTL=1 的报文之后，到达中型网络之后就会发现 TTL=0 了，此时就会往源机器(也就是A)发出一个ICMP差错不可达报文。然后计算机A就发送一个 TTL=2 的报文，以此类推，就获得了路径上所有的信息。  
***

## 传输层






